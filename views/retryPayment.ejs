<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Confirmation</title>
    <!-- Add your CSS stylesheets or links here -->
    <link rel="stylesheet" href="/css/User/style.css">
</head>

<body>

    <%- include('userHeader') %>

        <div class="container">
            <div class="row mt-5">
                <div class="col-lg-12 mt-4">
                    <div class="card QA_section border-0">
                        <div class="card-body QA_table">
                            <h2 class="text-center mb-4 text-danger">Payment Failed</h2>
                            <p class="text-center">Unfortunately, your payment was unsuccessful.</p>

                            <p class="text-center">Please try making the payment again.</p>
                            <!-- Add a button for retrying the payment -->
                            <div class="text-center">
                                <!-- <button onclick="handleButtonClick()" id="retryPayment" class="btn btn-primary">Retry
                                    Payment</button> -->
                                    <a href="/userCheckout" class="btn btn-primary">Retry
                                        Payment</a>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="footer">
            <div class="container">
                <div class="row">
                    <div class="col-12 text-center">
                        <div class="social-icons">
                            <a href="#"><span class="icon-facebook"></span></a>
                            <a href="#"><span class="icon-twitter"></span></a>
                            <a href="#"><span class="icon-youtube"></span></a>
                            <a href="#"><span class="icon-instagram"></span></a>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div class="copyright">
                            <p>
                                Copyright &copy;
                                <script>document.write(new Date().getFullYear());</script> All rights reserved | This
                                template is
                                Designed <i class="icon-heart text-danger" aria-hidden="true"></i> by
                                <a target="_blank">by Paul Boby T</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div id="loader" class="show fullscreen">
            <svg class="circular" width="48px" height="48px">
                <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
                <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10"
                    stroke="#ff5e15" />
            </svg>
        </div>

        <!-- Scripts -->
        <!-- <script>
            function handleButtonClick() {
                const paymentOption = document.querySelector('input[name="paymentMethod"]:checked').value;
                const selectedAddress = document.querySelector('input[name="selectedAddress"]:checked');
                console.log("data checking", paymentOption, selectedAddress)
                if (!validateCheckout()) {
                    return; // Stop further execution if the form is not valid
                }
                if (paymentOption === 'onlinePayment' && validateCheckout()) {
                    btnClick();
                } else {
                    const form = document.getElementById('checkOut');
                    if (form) {
                        form.submit();
                    }
                }
            }
            let totalAmount = document.getElementById('checkout-total').value;




            async function btnClick() {
                var paymentOption = document.querySelector('input[name="paymentMethod"]:checked').value;
                if (paymentOption == "onlinePayment" && validateCheckout()) {


                    try {

                        const totalAmountText = document.getElementById('checkout-total-amt').textContent.replace('â‚¹', '');

                        const totalAmount = totalAmountText



                        const response = await fetch('/createOrder', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify({
                                paymentOption: paymentOption,
                                totalAmount: totalAmount,
                                currency: 'INR',
                            }),
                        });
                        const data = await response.json();
                        console.log('DATA : ', data.order);
                        console.log('DATA : ', data.amount);
                        console.log('DATA : ', data.currency);
                        console.log('signature:', data.signature);

                        if (data.paymentOption == 'onlinePayment') {
                            console.log("working")
                            const order = data.order;
                            const orderId = order.id;
                            console.log("order", order)
                            console.log("orderId", orderId)
                            // If it's for online payment, proceed with Razorpay
                            const options = {
                                key: 'rzp_test_pHTxdeMnlEh2z8',
                                amount: data.amount,
                                currency: data.currency,
                                name: 'Elixr Cellar',
                                description: 'Test Transaction',
                                order_id: orderId,
                                handler: function (response) {
                                    console.log("Handler response data", response);
                                    verifyPayment(response, data)
                                },
                                "modal": {
                                    "ondismiss": function () {
                                        console.log('Payment window closed');
                                        paymentFailed(data);
                                    }
                                },
                                prefill: {
                                    name: 'John Doe',
                                    email: 'john@example.com',
                                    contact: '9000090000',
                                },
                                theme: {
                                    color: '#fb7b24',
                                },
                            };

                            const rzp = new Razorpay(options);
                            rzp.open();
                        }
                    } catch (error) {
                        console.error('Error initiating payment:', error);
                        console.error('Full error object:', error);
                        alert('Error during payment. Please try again.');
                    }
                }
            }
        </script> -->
        <script src="js/jquery-3.3.1.min.js"></script>
        <script src="js/jquery-migrate-3.0.1.min.js"></script>
        < <script src="js/jquery-ui.js">
            </script>
            <script src="js/popper.min.js"></script>
            <script src="js/bootstrap.min.js"></script>
            <script src="js/owl.carousel.min.js"></script>
            <script src="js/jquery.stellar.min.js"></script>
            <script src="js/jquery.countdown.min.js"></script>
            <script src="js/bootstrap-datepicker.min.js"></script>
            <script src="js/jquery.easing.1.3.js"></script>
            <script src="js/aos.js"></script>
            <script src="js/jquery.fancybox.min.js"></script>
            <script src="js/jquery.sticky.js"></script>
            <script src="js/jquery.mb.YTPlayer.min.js"></script>
            <script src="js/main.js"></script>


            <script async src="https://www.googletagmanager.com/gtag/js?id=UA-23581568-13"></script>
            <script>
                window.dataLayer = window.dataLayer || [];
                function gtag() { dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-23581568-13');
            </script>


            <script defer
                src="https://static.cloudflareinsights.com/beacon.min.js/v84a3a4012de94ce1a686ba8c167c359c1696973893317"
                integrity="sha512-euoFGowhlaLqXsPWQ48qSkBSCFs3DPRyiwVu3FjR96cMPx+Fr+gpWRhIafcHwqwCqWS42RZhIudOvEI+Ckf6MA=="
                data-cf-beacon='{"rayId":"831badfbec2fa3da","b":1,"version":"2023.10.0","token":"cd0b4b3a733644fc843ef0b185f98241"}'
                crossorigin="anonymous"></script>


            <script>

            </script>
</body>

</html>